.#{$prefix}-navbar {
  --item-line-color: var(--gray-300);

  [data-theme="dark"] &,
  &[data-theme="dark"] {
    --item-line-color: var(--gray-400);
  }

  $root: &;
  position: relative;
  display: flex;
  flex-wrap: wrap; // allow us to do the line break for collapsing content
  align-content: baseline;
  align-items: center;
  justify-content: space-between;
  min-height: var(--navbar-height);
  padding: $navbar-padding-y $navbar-padding-x;
  background-color: var(--components-background-color);
  @include transition(transform 350ms 100ms, background-color .35s, height 350ms 100ms);

  @include media-breakpoint-down(sm) {
    min-height: var(--navbar-height-sm);
    padding: $navbar-padding-y $spacer;
  }

  &--sm {
    min-height: var(--navbar-height-sm);

    #{$root}__brand,
    #{$root}__nav-item,
    #{$root}__nav-link {
      height: var(--navbar-height-sm);
    }

    #{$root}__logo {
      width: 4.125rem;
    }
  }

  > .container,
  > .container-fluid {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-between;
  }

  &__brand {
    display: flex;
    align-items: center;
    height: var(--navbar-height);

    @include media-breakpoint-down(sm) {
      height: var(--navbar-height-sm);
    }
  }

  &__logo {
    display: block;
    max-width: 5.4375rem;
    height: calc(var(--navbar-height) - (#{$spacer} * 2 * 2));
    max-height: 100%;
    fill: $blue-engie;

    @include media-breakpoint-down(sm) {
      max-width: 4.125rem;
      height: calc(var(--navbar-height-sm) - (#{$spacer} * 2));
    }

    &--white {
      fill: $white;
    }
  }

  &__nav {
    display: flex;
    flex-direction: column;
    @include list-unstyled();
    margin: 0;

    &-item {
      box-sizing: content-box;
      height: var(--navbar-height);
      border-bottom: 1px solid var(--item-line-color);

      @include media-breakpoint-down(sm) {
        height: calc(var(--navbar-height-sm) + 1px);
      }
    }

    &-link {
      position: relative;
      display: flex;
      align-items: center;
      height: var(--navbar-height);
      margin: 0;
      color: var(--body-text-color);
      font-weight: $font-weight-base;
      font-size: $font-size-base;
      transition-property: color;
      @include material-animation-fast-out-slow-in(.3s);

      @include media-breakpoint-down(sm) {
        height: var(--navbar-height-sm);
      }

      &::after {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: .125rem;
        background: theme-color("primary");
        opacity: 0;
        transition-property: opacity;
        content: "";
        @include material-animation-fast-out-slow-in(.3s);

        @include media-breakpoint-down(md) {
          bottom: -2px;
        }
      }

      &.active,
      &:hover {
        color: var(--body-text-color);
        text-decoration: none;

        &::after {
          opacity: 1;
        }
      }

      &.disabled {
        color: var(--disabled-color);
        cursor: default;
        pointer-events: none;
      }

      &--icon {
        &::after {
          content: none;
        }
      }
    }
  }

  &__toggler {
    padding: 0;
    background-color: transparent;
    border: 0;
    cursor: pointer;

    &-icon.material-icons {
      display: block;
      color: theme-color("primary");
    }
  }

  &__search {
    display: flex;
    flex-direction: row;
    align-items: center;
    height: 100%;
    margin: 0;
    padding: 0 $navbar-padding-x;
    background-color: var(--components-background-color);

    // Overide default collapse position
    &,
    &.nj-collapsing {
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      @include material-animation-default(.1s);
    }

    &.nj-collapsing,
    &.show {
      width: 100%;
    }

    &.show {
      opacity: 1;
      transition-property: opacity;
    }
  }

  &--shadow {
    box-shadow: $shadow-4dp;
  }

  &--transparent:not(&--shown-collapse) {
    background: transparent;
    box-shadow: none !important; // stylelint-disable-line

    #{$root}__nav-link {
      color: $white;

      &::after {
        background: $white;
      }
    }

    #{$root}__logo {
      fill: $white;
    }

    #{$root}__toggler-icon {
      color: $white;
    }
  }

  &--transparent,
  &--transparent &--shown-collapse {
    box-shadow: none !important; // stylelint-disable-line
    #{$root}__logo {
      fill: var(--theme-primary);
    }
  }

  &--collapse {
    flex-basis: 100%;
    flex-grow: 1;
    // For always expanded or extra full navbars, ensure content aligns itself
    // properly vertically. Can be easily overridden with flex utilities.
    align-items: center;
  }

  // Generate series of `.nj-navbar--expand-*` responsive modifier for configuring
  // where your nj-navbar collapses.
  &--expand {
    @each $breakpoint in map-keys($breakpoints) {
      $next: breakpoint-next($breakpoint, $breakpoints);
      $infix: breakpoint-infix($next, $breakpoints);

      &#{$infix} {
        @include media-breakpoint-down($breakpoint) {
          > .container,
          > .container-fluid {
            padding-right: 0;
            padding-left: 0;
          }
        }

        @include media-breakpoint-up($next) {
          flex-flow: row nowrap;
          justify-content: flex-start;

          .#{$prefix}-navbar__nav {
            flex-direction: row;

            &-item {
              border: 0;
            }

            &-link {
              margin-right: $navbar-nav-link-padding-x;
              margin-left: $navbar-nav-link-padding-x;

              &--icon {
                margin-right: $spacer;
                margin-left: $spacer;

                i {
                  pointer-events: none;
                }
              }
            }
          }

          // For nesting containers, have to redeclare for alignment purposes
          > .container,
          > .container-fluid {
            flex-wrap: nowrap;
          }

          .#{$prefix}-navbar--collapse {
            display: flex !important; // stylelint-disable-line declaration-no-important
            flex-basis: auto; // Changes flex-bases to auto because of an IE10 bug
          }

          .#{$prefix}-navbar__toggler {
            display: none;
          }
        }
      }
    }
  }
}
